<script>
  window.onload = () => {
    const freezeButton = document.getElementById('freezeButton');
    const sceneEl = document.querySelector('a-scene');

    let isFrozen = false;

    sceneEl.addEventListener('loaded', () => {
      const targetWrapper = document.getElementById('targetWrapper');
      const frozenModel = document.getElementById('frozenModel');
      const frozenModelEntity = document.getElementById('frozenModelEntity');
      const targetModelEntity = document.getElementById('modelEntity');

      const targetObj = targetWrapper.object3D;
      const frozenObj = frozenModel.object3D;

      targetWrapper.addEventListener('targetFound', () => {
        console.log("üìç Marker bulundu!");
        if (!isFrozen) {
          targetWrapper.setAttribute('visible', 'true');
          frozenModel.setAttribute('visible', 'false');
        }
      });

      targetWrapper.addEventListener('targetLost', () => {
        console.log("‚ùå Marker kayboldu!");
        if (!isFrozen) {
          targetWrapper.setAttribute('visible', 'false');
        } else {
          frozenModel.setAttribute('visible', 'true');
          targetWrapper.setAttribute('visible', 'false');
        }
      });

      freezeButton.addEventListener('click', () => {
        if (!isFrozen) {
          // Pozisyon ve rotasyonu d√ºnya koordinatlarƒ± olarak alƒ±yoruz
          const worldPos = new THREE.Vector3();
          const worldQuat = new THREE.Quaternion();

          targetObj.getWorldPosition(worldPos);
          targetObj.getWorldQuaternion(worldQuat);

          frozenObj.position.copy(worldPos);
          frozenObj.quaternion.copy(worldQuat);

          // Model √∂l√ßeƒüini e≈üitle
          const scale = targetModelEntity.getAttribute('scale');
          frozenModelEntity.setAttribute('scale', scale);

          // Donmu≈ü modeli g√∂r√ºn√ºr yap
          frozenModel.setAttribute('visible', 'true');

          // Marker modelini gizle
          targetWrapper.setAttribute('visible', 'false');

          freezeButton.innerText = '√á√∂z';
          isFrozen = true;

        } else {
          // Donmu≈ü modeli gizle, marker modelini g√∂ster
          frozenModel.setAttribute('visible', 'false');
          targetWrapper.setAttribute('visible', 'true');

          freezeButton.innerText = 'Dondur';
          isFrozen = false;
        }
      });
    });
  };
</script>
